var RegionesYcomunas = {"regiones": [{"NombreRegion": {"id":15, "valor":"Región de Arica y Parinacota"},
"comunas": [{"id":10201,"valor":"Arica"}, {"id":10202,"valor":"Camarones"}, {"id":10102,"valor":"Putre"}, {"id":10101,
	"valor":"General Lagos"}]},
{"NombreRegion": {"id":1,"valor":"Región de Tarapacá"},
"comunas": [{"id":10304,"valor":"Iquique"}, {"id":10307,"valor":"Alto Hospicio"}, {"id":10303,"valor":"Pozo Almonte"},
	{"id":10301,"valor":"Camiña"}, {"id":10306,"valor":"Colchane"}, {"id":10302,"valor":"Huara"}, {"id":10305,"valor":
			"Pica"}]},
{"NombreRegion": {"id":2,"valor":"Región de Antofagasta"},
"comunas": [{"id":20303,"valor":"Antofagasta"}, {"id":20302,"valor":"Mejillones"}, {"id":20301,"valor":"Sierra Gorda"},
	{"id":20304,"valor":"Taltal"}, {"id":20202,"valor":"Calama"}, {"id":20201,"valor":"Ollagüe"}, {"id":20203,"valor":
			"San Pedro de Atacama"}, {"id":20101,"valor":"Tocopilla"}, {"id":20102,"valor":"María Elena"}]},
{"NombreRegion": {"id":3,"valor":"Región de Atacama"},
"comunas": [{"id":30202,"valor":"Copiapó"}, {"id":30201,"valor":"Caldera"}, {"id":30203,"valor":"Tierra Amarilla"},
	{"id":30102,"valor":"Chañaral"}, {"id":30101,"valor":"Diego de Almagro"}, {"id":30303,"valor":"Vallenar"},
	{"id":30304,"valor":"Alto del Carmen"}, {"id":30302,"valor":"Freirina"}, {"id":30301,"valor":"Huasco"}]},
{"NombreRegion": {"id":4,"valor":"Región de Coquimbo"},
"comunas": [{"id":40102,"valor":"La Serena"}, {"id":40105,"valor":"Coquimbo"}, {"id":40106,"valor":"Andacollo"},
	{"id":40101,"valor":"La Higuera"}, {"id":40104,"valor":"Paihuano"}, {"id":40103,"valor":"Vicuña"},
	{"id":40302,"valor":"Illapel"}, {"id":40305,"valor":"Canela"},{"id":40304,"valor":"Los Vilos"},
	{"id":40303,"valor":"Salamanca"}, {"id":40202,"valor":"Ovalle"}, {"id":40205,"valor":"Combarbalá"},
	{"id":40203,"valor":"Monte Patria"}, {"id":40204,"valor":"Punitaqui"}, {"id":40201,"valor":"Río Hurtado"}]},
{"NombreRegion": {"id":5,"valor":"Región de Valparaíso"},
"comunas": [{"id":50506,"valor":"Valparaíso"}, {"id":50508,"valor":"Casablanca"}, {"id":50509,"valor":"Concón"},
	{"id":50507,"valor":"Juan Fernández"}, {"id":50501,"valor":"Puchuncaví"}, {"id":50502,"valor":"Quintero"},
	{"id":50503,"valor":"Viña del Mar"}, {"id":50601,"valor":"Isla de Pascua"}, {"id":50401,"valor":"Los Andes"},
	{"id":50403,"valor":"Calle Larga"}, {"id":50402,"valor":"Rinconada"}, {"id":50404,"valor":"San Esteban"},
	{"id":50104,"valor":"La Ligua"}, {"id":50102,"valor":"Cabildo"}, {"id":50103,"valor":"Papudo"},
	{"id":50101,"valor":"Petorca"}, {"id":50105,"valor":"Zapallar"}, {"id":50305,"valor":"Quillota"},
	{"id":50302,"valor":"Calera"}, {"id":50303,"valor":"Hijuelas"}, {"id":50304,"valor":"La Cruz"},
	{"id":50301,"valor":"Nogales"}, {"id":50705,"valor":"San Antonio"}, {"id":50701,"valor":"Algarrobo"},
	{"id":50704,"valor":"Cartagena"}, {"id":50702,"valor":"El Quisco"}, {"id":50703,"valor":"El Tabo"},
	{"id":50706,"valor":"Santo Domingo"}, {"id":50203,"valor":"San Felipe"}, {"id":50205,"valor":"Catemu"},
	{"id":50206,"valor":"Llaillay"}, {"id":50707,"valor":"Panquehue"}, {"id":50201,"valor":"Putaendo"},
	{"id":50202,"valor":"Santa María"}, {"id":50505,"valor":"Quilpué"}, {"id":50307,"valor":"Limache"},
	{"id":50306,"valor":"Olmué"}, {"id":50504,"valor":"Villa Alemana"}]},
{"NombreRegion": {"id":6,"valor":"Región del Libertador Gral. Bernardo O’Higgins"},
"comunas": [{"id":60105,"valor":"Rancagua"}, {"id":60102,"valor":"Codegua"}, {"id":60109,"valor":"Coinco"},
	{"id":60110,"valor":"Coltauco"}, {"id":60107,"valor":"Doñihue"}, {"id":60103,"valor":"Graneros"},
	{"id":60112,"valor":"Las Cabras"}, {"id":60104,"valor":"Machalí"}, {"id":60116,"valor":"Malloa"},
	{"id":60101,"valor":"Mostazal"}, {"id":60106,"valor":"Olivar"}, {"id":60114,"valor":"Peumo"},
	{"id":60115,"valor":"Pichidegua"}, {"id":60111,"valor":"Quinta de Tilcoco"}, {"id":60113,"valor":"Rengo"},
	{"id":60108,"valor":"Requínoa"}, {"id":60117,"valor":"San Vicente"}, {"id":60204,"valor":"Pichilemu"},
	{"id":60202,"valor":"La Estrella"}, {"id":60205,"valor":"Litueche"}, {"id":60203,"valor":"Marchihue"},
	{"id":60201,"valor":"Navidad"}, {"id":60206,"valor":"Paredones"}, {"id":60301,"valor":"San Fernando"},
	{"id":60309,"valor":"Chépica"}, {"id":60304,"valor":"Chimbarongo"}, {"id":60310,"valor":"Lolol"},
	{"id":60306,"valor":"Nancagua"}, {"id":60305,"valor":"Palmilla"}, {"id":60302,"valor":"Peralillo"},
	{"id":60303,"valor":"Placilla"}, {"id":60308,"valor":"Pumanque"}, {"id":60307,"valor":"Santa Cruz"}]},
{"NombreRegion": {"id":7,"valor":"Región del Maule"},
"comunas": [{"id":70204,"valor":"Talca"}, {"id":70207,"valor":"Constitución"}, {"id":70202,"valor":"Curepto"},
	{"id":70209,"valor":"Empedrado"}, {"id":70208,"valor":"Maule"}, {"id":70203,"valor":"Pelarco"},
	{"id":70205,"valor":"Pencahue"}, {"id":70201,"valor":"Río Claro"}, {"id":70206,"valor":"San Clemente"},
	{"id":70210,"valor":"San Rafael"}, {"id":70403,"valor":"Cauquenes"}, {"id":70401,"valor":"Chanco"},
	{"id":70402,"valor":"Pelluhue"}, {"id":70104,"valor":"Curicó"}, {"id":70106,"valor":"Hualañé"},
	{"id":70109,"valor":"Licantén"}, {"id":70108,"valor":"Molina"}, {"id":70103,"valor":"Rauco"},
	{"id":70102,"valor":"Romeral"}, {"id":70105,"valor":"Sagrada Familia"}, {"id":70101,"valor":"Teno"},
	{"id":70107,"valor":"Vichuquén"}, {"id":70305,"valor":"Linares"}, {"id":70302,"valor":"Colbún"},
	{"id":70306,"valor":"Longaví"}, {"id":70308,"valor":"Parral"}, {"id":70307,"valor":"Retiro"},
	{"id":70301,"valor":"San Javier"}, {"id":70303,"valor":"Villa Alegre"}, {"id":70304,"valor":"Yerbas Buenas"}]},
{"NombreRegion": {"id":8,"valor":"Región del Biobío"},
"comunas": [{"id":80205,"valor":"Concepción"}, {"id":80207,"valor":"Coronel"}, {"id":80210,"valor":"Chiguayante"},
	{"id":80202,"valor":"Florida"}, {"id":80206,"valor":"Hualqui"}, {"id":80208,"valor":"Lota"},
	{"id":80203,"valor":"Penco"}, {"id":80211,"valor":"San Pedro de la Paz"}, {"id":80209,"valor":"Santa Juana"},
	{"id":80204,"valor":"Talcahuano"}, {"id":80201,"valor":"Tomé"}, {"id":80212,"valor":"Hualpén"},
	{"id":80404,"valor":"Lebu"}, {"id":80401,"valor":"Arauco"}, {"id":80405,"valor":"Cañete"},
	{"id":80406,"valor":"Contulmo"}, {"id":80402,"valor":"Curanilahue"}, {"id":80403,"valor":"Los Álamos"},
	{"id":80407,"valor":"Tirúa"}, {"id":80308,"valor":"Los Ángeles"}, {"id":80304,"valor":"Antuco"},
	{"id":80301,"valor":"Cabrero"}, {"id":80306,"valor":"Laja"}, {"id":80313,"valor":"Mulchén"},
	{"id":80309,"valor":"Nacimiento"}, {"id":80310,"valor":"Negrete"}, {"id":80312,"valor":"Quilaco"},
	{"id":80307,"valor":"Quilleco"}, {"id":80305,"valor":"San Rosendo"}, {"id":80311,"valor":"Santa Bárbara"},
	{"id":80303,"valor":"Tucapel"}, {"id":80302,"valor":"Yumbel"}, {"id":80314,"valor":"Alto Biobío"},
	{"id":80110,"valor":"Chillán"}, {"id":80114,"valor":"Bulnes"}, {"id":80101,"valor":"Cobquecura"},
	{"id":80113,"valor":"Coelemu"}, {"id":80109,"valor":"Coihueco"}, {"id":80121,"valor":"Chillán Viejo"},
	{"id":80118,"valor":"El Carmen"}, {"id":80106,"valor":"Ninhue"}, {"id":80102,"valor":"Ñiquén"},
	{"id":80119,"valor":"Pemuco"}, {"id":80112,"valor":"Pinto"}, {"id":80111,"valor":"Portezuelo"},
	{"id":80117,"valor":"Quillón"}, {"id":80105,"valor":"Quirihue"}, {"id":80116,"valor":"Ránquil"},
	{"id":80104,"valor":"San Carlos"}, {"id":80103,"valor":"San Fabián"}, {"id":80115,"valor":"San Ignacio"},
	{"id":80108,"valor":"San Nicolás"}, {"id":80107,"valor":"Treguaco"}, {"id":80120,"valor":"Yungay"}]},
{"NombreRegion": {"id":9,"valor":"Región de la Araucanía"},
"comunas": [{"id":90205,"valor":"Temuco"}, {"id":90206,"valor":"Carahue"}, {"id":90210,"valor":"Cunco"},
	{"id":90218,"valor":"Curarrehue"}, {"id":90211,"valor":"Freire"}, {"id":90202,"valor":"Galvarino"},
	{"id":90214,"valor":"Gorbea"}, {"id":90203,"valor":"Lautaro"}, {"id":90219,"valor":"Loncoche"},
	{"id":90207,"valor":"Melipeuco"}, {"id":90208,"valor":"Nueva Imperial"}, {"id":90220,"valor":"Padre las Casas"},
	{"id":90201,"valor":"Perquenco"}, {"id":90212,"valor":"Pitrufquén"}, {"id":90215,"valor":"Pucón"},
	{"id":90209,"valor":"Saavedra"}, {"id":90213,"valor":"Teodoro Schmidt"}, {"id":90217,"valor":"Toltén"},
	{"id":90204,"valor":"Vilcún"}, {"id":90216,"valor":"Villarrica"}, {"id":90221,"valor":"Cholchol"},
	{"id":90102,"valor":"Angol"}, {"id":90103,"valor":"Collipulli"}, {"id":90110,"valor":"Curacautín"},
	{"id":90106,"valor":"Ercilla"}, {"id":90111,"valor":"Lonquimay"}, {"id":90104,"valor":"Los Sauces"},
	{"id":90107,"valor":"Lumaco"}, {"id":90105,"valor":"Purén"}, {"id":90101,"valor":"Renaico"},
	{"id":90109,"valor":"Traiguén"}, {"id":90108,"valor":"Victoria"}]},
{"NombreRegion": {"id":14,"valor":"Región de Los Ríos"},
"comunas": [{"id":100105,"valor":"Valdivia"}, {"id":100107,"valor":"Corral"}, {"id":100101,"valor":"Lanco"},
	{"id":100106,"valor":"Los Lagos"}, {"id":100104,"valor":"Máfil"}, {"id":100102,"valor":"Mariquina"},
	{"id":100108,"valor":"Paillaco"}, {"id":100103,"valor":"Panguipulli"}, {"id":100111,"valor":"La Unión"},
	{"id":100109,"valor":"Futrono"}, {"id":100110,"valor":"Lago Ranco"}, {"id":1001112,"valor":"Río Bueno"}]},
{"NombreRegion": {"id":10,"valor":"Región de Los Lagos"},
"comunas": [{"id":100306,"valor":"Puerto Montt"}, {"id":100308,"valor":"Calbuco"}, {"id":100309,"valor":"Cochamó"},
	{"id":100302,"valor":"Fresia"}, {"id":100301,"valor":"Frutillar"}, {"id":100305,"valor":"Los Muermos"},
	{"id":100303,"valor":"Llanquihue"}, {"id":100307,"valor":"Maullín"}, {"id":100304,"valor":"Puerto Varas"},
	{"id":100405,"valor":"Castro"}, {"id":100401,"valor":"Ancud"}, {"id":100406,"valor":"Chonchi"},
	{"id":100404,"valor":"Curaco de Vélez"}, {"id":100403,"valor":"Dalcahue"}, {"id":100410,"valor":"Puqueldón"},
	{"id":100407,"valor":"Queilén"}, {"id":100408,"valor":"Quellón"}, {"id":100402,"valor":"Quemchi"},
	{"id":100409,"valor":"Quinchao"}, {"id":100203,"valor":"Osorno"}, {"id":100207,"valor":"Puerto Octay"},
	{"id":100206,"valor":"Purranque"}, {"id":100204,"valor":"Puyehue"}, {"id":100205,"valor":"Río Negro"},
	{"id":100202,"valor":"San Juan de la Costa"}, {"id":100201,"valor":"San Pablo"}, {"id":100501,"valor":"Chaitén"},
	{"id":100502,"valor":"Futaleufú"}, {"id":100504,"valor":"Hualaihué"}, {"id":100503,"valor":"Palena"}]},
{"NombreRegion": {"id":11,"valor":"Región Aisén del Gral. Carlos Ibáñez del Campo"},
"comunas": [{"id":110201,"valor":"Coihaique"}, {"id":110202,"valor":"Lago Verde"}, {"id":110103,"valor":"Aisén"},
	{"id":110102,"valor":"Cisnes"}, {"id":110101,"valor":"Guaitecas"}, {"id":110401,"valor":"Cochrane"},
	{"id":110403,"valor":"O’Higgins"}, {"id":110402,"valor":"Tortel"}, {"id":110302,"valor":"Chile Chico"},
	{"id":110301,"valor":"Río Ibáñez"}]},
{"NombreRegion": {"id":12,"valor":"Región de Magallanes"},
"comunas": [{"id":120204,"valor":"Punta Arenas"}, {"id":120201,"valor":"Laguna Blanca"},
	{"id":120203,"valor":"Río Verde"}, {"id":120202,"valor":"San Gregorio"}, {"id":120402,"valor":"Cabo de Hornos"},
	{"id":120401,"valor":"Antártica"}, {"id":120301,"valor":"Porvenir"}, {"id":120302,"valor":"Primavera"},
	{"id":120303,"valor":"Timaukel"}, {"id":120102,"valor":"Natales"}, {"id":120101,"valor":"Torres del Paine"}]},
{"NombreRegion": {"id":13,"valor":"Región Metropolitana"},
"comunas": [{"id":130230,"valor":"Cerrillos"}, {"id":130232,"valor":"Cerro Navia"}, {"id":130201,"valor":"Conchalí"},
	{"id":130226,"valor":"El Bosque"}, {"id":130229,"valor":"Estación Central"}, {"id":130217,"valor":"Huechuraba"},
	{"id":130216,"valor":"Independencia"}, {"id":130213,"valor":"La Cisterna"}, {"id":130214,"valor":"La Florida"},
	{"id":130215,"valor":"La Granja"}, {"id":130224,"valor":"La Pintana"}, {"id":130209,"valor":"La Reina"},
	{"id":130204,"valor":"Las Condes"}, {"id":130220,"valor":"Lo Barnechea"}, {"id":130228,"valor":"Lo Espejo"},
	{"id":130231,"valor":"Lo Prado"}, {"id":130221,"valor":"Macul"}, {"id":130212,"valor":"Maipú"},
	{"id":130210,"valor":"Ñuñoa"}, {"id":130227,"valor":"Pedro Aguirre Cerda"}, {"id":130222,"valor":"Peñalolén"},
	{"id":130207,"valor":"Providencia"}, {"id":130205,"valor":"Pudahuel"}, {"id":130202,"valor":"Quilicura"},
	{"id":130206,"valor":"Quinta Normal"}, {"id":130218,"valor":"Recoleta"}, {"id":130203,"valor":"Renca"},
	{"id":130223,"valor":"San Joaquín"}, {"id":130211,"valor":"San Miguel"}, {"id":130225,"valor":"San Ramón"},
	{"id":130219,"valor":"Vitacura"}, {"id":130302,"valor":"Puente Alto"}, {"id":130303,"valor":"Pirque"},
	{"id":130301,"valor":"San José de Maipo"}, {"id":130102,"valor":"Colina"}, {"id":130103,"valor":"Lampa"},
	{"id":130101,"valor":"Tiltil"}, {"id":130401,"valor":"San Bernardo"}, {"id":130403,"valor":"Buin"},
	{"id":130402,"valor":"Calera de Tango"}, {"id":130404,"valor":"Paine"}, {"id":130603,"valor":"Melipilla"},
	{"id":130605,"valor":"Alhué"}, {"id":130601,"valor":"Curacaví"}, {"id":130602,"valor":"María Pinto"},
	{"id":130604,"valor":"San Pedro"}, {"id":130502,"valor":"Talagante"}, {"id":130503,"valor":"El Monte"},
	{"id":130504,"valor":"Isla de Maipo"}, {"id":130606,"valor":"Padre Hurtado"}, {"id":130501,"valor":"Peñaflor"},
	{"id":130208,"valor":"Santiago"}]}]};
var archivosSeleccionados = 1;
var regionesYComunasMostradas = 0;

$('document').ready(function() {
	// Se esconden elementos cuya aparición solo es gatillada por acciones específicas realizadas en la página
	$('#más-espacio-necesario').hide();
	$('#foto-mascota2').hide();
	$('#foto-mascota3').hide();
	$('#foto-mascota4').hide();
	$('#foto-mascota5').hide();

	$('#más-espacio-disponible').hide();
	$('#extra1').hide();
	$('#extra2').hide();
	$('#extra3').hide();
	$('#extra4').hide();

	// Se inicializan los selectores de origen y destino con los valores de las regiones de Chile
	generarRegionesYComunas($('#region-origen'), $('#comuna-origen'));
	generarRegionesYComunas($('#region-destino'), $('#comuna-destino'));

	generarRegionesYComunas($('#region-disponible'), $('#comuna-disponible'));

	// Se inicializa el datepicker para escoger la fecha del viaje
	var fechaInicial = new Date();
	fechaInicial.setDate(fechaInicial.getDate() + 1);
	
	$('#fecha-viaje').datepicker({
        dateFormat: 'yy-mm-dd',
        minDate: fechaInicial,
		inline: true,
        showOtherMonths: true,
        dayNamesMin: ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'],
        monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre',
            'Noviembre', 'Diciembre']
	});

	// En caso de escoger la opción "más" como espacio necesario, se gatilla la aparición de un cuadro de texto para
	// ingresar el valor deseado
	$("#espacio-necesario").on("change", function(event) {
	    if($('#espacio-necesario').val() == "más") {
			$('#más-espacio-necesario').show();
		} else {
			$('#más-espacio-necesario').hide();
		}
    });

	// Al hacer click en el botón "agregar otro archivo", se gatilla la aparición de un nuevo elemento input de tipo
	// file que permita ingresar otro archivo, considerando un máximo de 5 archivos
	$('#agregar-otro-archivo').on("click", function() {
		archivosSeleccionados++;
		if(archivosSeleccionados <= 5) {
            var string = '#foto-mascota' + archivosSeleccionados;
            $(string).show();
        }
        if(archivosSeleccionados == 5) {
			$('#agregar-otro-archivo').hide();
		}
	});

	// Validación de formulario
	$('#enviar-traslado').on("click", function() {
		// Validación región de origen
	    if($('#region-origen').val() == null) {
			errorCampoVacio('#region-origen');
		} else {
	        errorCampoVacio('#region-origen', true);
        }
        // Validación comuna de origen
		if($('#comuna-origen').val() == null) {
			errorCampoVacio('#comuna-origen');
		} else {
		    errorCampoVacio('#comuna-origen', true);
        }

        // Validación región de destino
		if($('#region-destino').val() == null) {
			errorCampoVacio('#region-destino');
		} else {
		    errorCampoVacio('#region-destino', true);
        }
        // Validación comuna de destino
		if($('#comuna-destino').val() == null) {
			errorCampoVacio('#comuna-destino');
		} else {
		    errorCampoVacio('#comuna-destino', true);
        }

        // Validación fecha de viaje
        if($('#fecha-viaje').val() == "") {
        	errorCampoVacio('#fecha-viaje');
        	$('#fecha-viaje-span').text("Campo requerido");
        } else if(esFechaValida($('#fecha-viaje').val())) {
            errorCampoVacio('#fecha-viaje', true);
            $('#fecha-viaje-span').text("Campo requerido");
        } else {
            $('#fecha-viaje').css({"box-shadow": "0 0 3px #CC0000"});
            $('#fecha-viaje-span').text("Debe ingresar una fecha en el formato aaaa-mm-dd");
            $('#fecha-viaje-span').css({"display": "inline"});
        }
        // Validación espacio necesario
        if($('#espacio-necesario').val() == null) {
        	errorCampoVacio('#espacio-necesario');
        } else {
            errorCampoVacio('#espacio-necesario', true);
            if($('#espacio-necesario').val() == "más") {
            	// Validación más espacio necesario
                if($('#más-espacio-necesario-input').val() == "") {
                    errorCampoVacio('#más-espacio-necesario-input');
                } else {
                    errorCampoVacio('#más-espacio-necesario-input', true);
                }
            }
        }

        // Validación tipo de mascota
        if($('#tipo-mascota').val() == null) {
        	errorCampoVacio('#tipo-mascota');
        } else {
            errorCampoVacio('#tipo-mascota', true);
        }
        // Validación fotos mascota
        var fotosMascota = 0;
        if($('#foto-mascota').val() != "") {
        	fotosMascota++;
        }
        if($('#foto-mascota2').val() != "") {
        	fotosMascota++;
        }
        if($('#foto-mascota3').val() != "") {
        	fotosMascota++;
        }
        if($('#foto-mascota4').val() != "") {
        	fotosMascota++;
        }
        if($('#foto-mascota5').val() != "") {
        	fotosMascota++;
        }
        if(fotosMascota == 0) {
        	errorCampoVacio('#foto-mascota');
		} else {
            errorCampoVacio('#foto-mascota', true);
        }
        // Validación descripción mascota
        if($('#descripcion-mascota').val().length > 500) {
            errorCampoVacio('#descripcion-mascota');
        } else {
            errorCampoVacio('#descripcion-mascota', true);
        }

        // Validación nombre
		if($('#nombre').val() == "") {
        	errorCampoVacio('#nombre');
        	$('#nombre-span').text("Campo requerido");
        } else if($('#nombre').val().length < 3 || $('#nombre').val().length > 80) {
            $('#nombre').css({"box-shadow": "0 0 3px #CC0000"});
            $('#nombre-span').text("Debe ingresar un nombre de largo entre 3 y 80 caracteres");
            $('#nombre-span').css({"display": "inline"});
        } else {
		    errorCampoVacio('#nombre', true);
		    $('#nombre-span').text("Campo requerido");
        }
        // Validación email
        if($('#email').val() == "") {
        	errorCampoVacio('#email');
        	$('#email-span').text("Campo requerido");
        } else if(esEmailValido($('#email').val())) {
        	errorCampoVacio('#email', true);
            $('#email-span').text("Campo requerido");
        } else {
        	$('#email').css({"box-shadow": "0 0 3px #CC0000"});
            $('#email-span').text("Debe ingresar un email válido");
            $('#email-span').css({"display": "inline"});
        }

        // Validación celular
        if(esCelularValido($('#celular').val()) || $('#celular').val() == "") {
        	errorCampoVacio('#celular', true);
        } else {
        	errorCampoVacio('#celular');
        }
    });

	// En caso de escoger la opción "más" como espacio disponible, se gatilla la aparición de un cuadro de texto para
	// ingresar el valor deseado
	$("#espacio-disponible").on("change", function(event) {
	    if($('#espacio-disponible').val() == "más") {
			$('#más-espacio-disponible').show();
		} else {
			$('#más-espacio-disponible').hide();
		}
    });

	// Al hacer click en el botón "agregar otra comuna, se gatilla la aparición de dos elementos input que permiten
	// ingresar otra región y comuna, considerando un máximo de 5
	$('#agregar-otra-comuna').on("click", function() {
		regionesYComunasMostradas++;
		if(regionesYComunasMostradas <= 4) {
			var stringRegion = '#region-extra' + regionesYComunasMostradas;
			var stringComuna = '#comuna-extra' + regionesYComunasMostradas;
			generarRegionesYComunas($(stringRegion), $(stringComuna));
            var string = '#extra' + regionesYComunasMostradas;
            $(string).show();
        }
        if(regionesYComunasMostradas == 4) {
			$('#agregar-otra-comuna').hide();
		}
	});

	// Validación de formulario
	$('#enviar-voluntario').on("click", function() {
		// Validación nombre
		if($('#nombre-voluntario').val() == "") {
        	errorCampoVacio('#nombre-voluntario');
        	$('#nombre-voluntario-span').text("Campo requerido");
        } else if($('#nombre-voluntario').val().length > 80) {
            $('#nombre-voluntario').css({"box-shadow": "0 0 3px #CC0000"});
            $('#nombre-voluntario-span').text("Debe ingresar un nombre con un largo de 80 caracteres o menos");
            $('#nombre-voluntario-span').css({"display": "inline"});
        } else {
		    errorCampoVacio('#nombre-voluntario', true);
		    $('#nombre-voluntario-span').text("Campo requerido");
        }

        // Validación email
        if($('#email-voluntario').val() == "") {
        	errorCampoVacio('#email-voluntario');
        	$('#email-voluntario-span').text("Campo requerido");
        } else if(esEmailValido($('#email-voluntario').val())) {
        	errorCampoVacio('#email-voluntario', true);
            $('#email-voluntario-span').text("Campo requerido");
        } else {
        	$('#email-voluntario').css({"box-shadow": "0 0 3px #CC0000"});
            $('#email-voluntario-span').text("Debe ingresar un email válido");
            $('#email-voluntario-span').css({"display": "inline"});
        }

         // Validación celular
        if(esCelularValido($('#celular-voluntario').val()) || $('#celular-voluntario').val() == "") {
        	errorCampoVacio('#celular-voluntario', true);
        } else {
        	errorCampoVacio('#celular-voluntario');
        }

        // Validación espacio disponible
        if($('#espacio-disponible').val() == null) {
        	errorCampoVacio('#espacio-disponible');
        } else {
            errorCampoVacio('#espacio-disponible', true);
            if($('#espacio-disponible').val() == "más") {
            	// Validación más espacio disponible
                if($('#más-espacio-disponible-input').val() == "") {
                    errorCampoVacio('#más-espacio-disponible-input');
                } else {
                    errorCampoVacio('#más-espacio-disponible-input', true);
                }
            }
        }

        // Validación región disponible
		if($('#region-disponible').val() == null) {
			errorCampoVacio('#region-disponible');
		} else {
		    errorCampoVacio('#region-disponible', true);
        }
        // Validación comuna disponible
		if($('#comuna-disponible').val() == null) {
			errorCampoVacio('#comuna-disponible');
		} else {
		    errorCampoVacio('#comuna-disponible', true);
        }

        // Validación regiones y comunas extra
		if(regionesYComunasMostradas > 0) {
			for(var i = 1; i <= regionesYComunasMostradas; i++) {
				var stringRegion = '#region-extra' + i;
				var stringComuna = '#comuna-extra' + i;
				if ($(stringRegion).val() != null && $(stringComuna).val() == null) {
					errorCampoVacio(stringComuna);
                } else {
					errorCampoVacio(stringComuna, true);
				}
			}
		}

        // Validación descripción voluntario
        if($('#descripcion-voluntario').val().length > 500) {
            errorCampoVacio('#descripcion-voluntario');
        } else {
            errorCampoVacio('#descripcion-voluntario', true);
        }
    });

	// Clicks en imágenes de mascotas
	$('#traslado1-imagen').on("click", function() {
		configurarModal('#myModal1', 0);
	});
	$('#traslado2-1-imagen').on("click", function() {
		configurarModal('#myModal2-1', 0);
	});
	$('#traslado2-2-imagen').on("click", function() {
		configurarModal('#myModal2-2', 1);
	});
	$('#traslado3-imagen').on("click", function() {
		configurarModal('#myModal3', 0);
	});
	$('#traslado4-imagen').on("click", function() {
		configurarModal('#myModal4', 0);
	});
	$('#traslado5-imagen').on("click", function() {
		configurarModal('#myModal5', 0);
	});

	// Mapa de Santiago en el menú principal
	var miMapa = L.map('mapa').setView([-33.4372, -70.6506], 13);
	L.marker([-33.4372, -70.6506]).addTo(miMapa);
	L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
		maxZoom: 18,
		id: 'mapbox.streets',
		accessToken: 'pk.eyJ1IjoicGlzYzFzIiwiYSI6ImNqdjMzd3J0bjAzdG4zeWxiYmR6M3Vtb3IifQ.maMdRyOIicEmjJ69iKRkQg'
	}).addTo(miMapa);
});

/**
 * Función que se encarga de mostrar un modal con una imagen de mayor tamaño a la original
 * @param id
 * @param i
 */
function configurarModal(id, i) {
	$(id).css({"display": "block"});
	var span = document.getElementsByClassName("close")[i];
	span.onclick = function() {
		$(id).css({"display": "none"});
	}
	window.onclick = function(event) {
	  if ('#' + event.target.id == id) {
		$(id).css({"display": "none"});
	  }
	}
}

/**
 * Función que utiliza una expresión regular para validar que el valor ingresado corresponda a un celular de Chile en el
 * formato +56911111111
 * @param celular
 * @returns {*|boolean}
 */
function esCelularValido(celular) {
	var exprReg = /^(\+?56)?(\s?)(0?9)(\s?)[987654321]\d{7}$/;
	return exprReg.test(celular);
}

/**
 * Función que utiliza una expresión regular para comprobar que el formato del email ingresado sea válido
 * @param email
 * @returns {*|boolean}
 */
function esEmailValido(email) {
    var exprReg = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return exprReg.test(String(email).toLowerCase());
}

/**
 * Función que utiliza una expresión regular para validar que el valor ingresado corresponda a una fecha en el formato
 * faaaa-mm-dd
 * @param fecha
 * @returns {boolean}
 */
function esFechaValida(fecha) {
    var exprReg = /^\d{4}-\d{2}-\d{2}$/;
    if(!fecha.match(exprReg)) {
        return false;
    }
    var d = new Date(fecha);
    if(Number.isNaN(d.getTime())) {
        return false;
    }
    return d.toISOString().slice(0,10) === fecha;
}

/**
 * Función que produce un resultado visible indicativo de un error de campo vacío. Específicamente, produce un borde
 * rojo en el input en cuestión, y además hace visible el mensaje de "Campo requerido".
 * En caso de que el valor reset sea verdadero, se deshacen las acciones mencionadas previamente.
 * @param id
 * @param reset
 */
function errorCampoVacio(id, reset=false) {
    var string = id + "-span";
    var boxShadow = "0 0 3px #CC0000";
    var display = "inline";
    if(reset) {
        boxShadow = "none";
        display = "none";
    }
    $(id).css({"box-shadow": boxShadow});
    $(string).css({"display": display});
}

/**
 * Función que genera las opciones de los selectores dados, correspondientes a las regiones y comunas de Chile
 * @param regiones
 * @param comunas
 */
function generarRegionesYComunas(regiones, comunas){
	var iRegion = 0;
	var htmlRegion = '<option disabled selected value="sin-region">Seleccionar región</option>';
	var htmlComunas = '<option disabled selected value="sin-region">Seleccionar comuna</option>';

	$.each(RegionesYcomunas.regiones, function () {
		htmlRegion = htmlRegion + '<option value="' + RegionesYcomunas.regiones[iRegion].NombreRegion.id + '">' +
			RegionesYcomunas.regiones[iRegion].NombreRegion.valor + '</option>';
		iRegion++;
	});

	regiones.html(htmlRegion);
	comunas.html(htmlComunas);

	regiones.change(function () {
		var iRegiones = 0;
		var valorRegion = $(this).val();
		var htmlComuna = '<option disabled selected value="sin-comuna">Seleccionar comuna</option>';
		$.each(RegionesYcomunas.regiones, function () {
			if (RegionesYcomunas.regiones[iRegiones].NombreRegion.id == valorRegion) {
				var iComunas = 0;
				$.each(RegionesYcomunas.regiones[iRegiones].comunas, function () {
					htmlComuna = htmlComuna + '<option value="' + RegionesYcomunas.regiones[iRegiones].comunas[iComunas].id
						+ '">' + RegionesYcomunas.regiones[iRegiones].comunas[iComunas].valor + '</option>';
					iComunas++;
				});
			}
			iRegiones++;
		});
		comunas.html(htmlComuna);
	});
}

